# :clap: 函数

> 简单是可靠性的先决条件。-- Edsger Dijkstra

## 短小

如果度量短小？一般20行封顶最佳。

对于代码块（if、else、while等），其中的代码块应该只有一行，改行大抵应该是一个函数调用语句。这样不但能保持函数短小，而且，因为块内调用的函数拥有较高说明性的名称，从而增加了文档上的价值。

函数的缩进层级不该多于一层或两层。

> [!tip]
> 短小的函数，易于阅读和理解。

这一点在[长函数](https://lvanliu.github.io/LvanNote/#/程序设计/代码的坏味道?id=_7-长函数)也有提及。

## 只做一件事

函数应该做一件事。做好这件事。只做一件事。

如果函数只是做了该函数名下同一抽象层上的步骤，则函数还是只做了一件事。编写函数毕竟是为了把大一些的概念（换言之，函数的名称）拆分为另一抽象层上的一系列步骤。

判断函数是否只做了一件事，就是看是否能再拆出一个函数，该函数不仅只是单纯地重新诠释其实现。

> [!tip]
> 只做一件事，也就是单一职责原则。

## 每个函数一个抽象层级

函数中混杂不同抽象层级，往往让人很迷惑。读者可能无法判断某个表达式是基础概念还是细节。更恶劣的是，就像破损的窗户，一旦细节与基础概念混杂，更多的细节就会在函数中纠结起来。

### 自顶向下读代码：向下规则

我们想要让代码拥有向下的阅读顺序。我们想要让每个函数后面都跟着位于下一抽象层级的函数，这样一来，在查看函数列表时，就能遵循抽象层级向下阅读了，这就是向下规则。

## switch语句

> 写出短小的switch语句很难。

使用switch语句会违背以下原则：

- 单一职责原则
- 开闭原则

可以使用多态来优化switch语句。这一点在[滥用控制语句](https://lvanliu.github.io/LvanNote/#/程序设计/代码的坏味道?id=_2-滥用控制语句)也被提及。